<div id="manage-<%= name %>-dropzone" class="dropzone"></div>

<script>
  Dropzone.autoDiscover = false;

  $(document).ready(function () {
    $("div#manage-<%= name %>-dropzone").dropzone({
      url: '<%= url_for({controller: name.pluralize, action: :create }) %>',
      paramName: '<%= name %>[document]',
      params: {
        "<%= name %>[<%= params[0] %>]": <%= params[1] %>,
        "authenticity_token": $('meta[name=csrf-token]').attr('content')
      },
      parallelUploads: 1,
      queuecomplete: function (file, response) {
        location.reload();
      }
    });
  })
</script>